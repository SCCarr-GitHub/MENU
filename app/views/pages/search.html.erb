<div class="home-header"><h1>Me.N.u</h1></div>
<div class="home-page-avatar">
  <% if user_signed_in? %>
    <% if current_user.photo.present? %>
      <%= cl_image_tag current_user.photo.key, class: "avatar" %>
    <% else %>
      <%= image_tag "https://www.nicepng.com/png/full/115-1150821_default-avatar-comments-sign-in-icon-png.png", class: "avatar" %>
    <% end %>
  <% end %>
</div>
<br>
<div class="search-container">
<%= form_tag(search_pages_path, method: :get) do %>
  <%= text_field_tag :query, params[:query], placeholder: "Search...", style: "width: 300px;" %>
  <%= submit_tag "Search", style: "background-color: #e2f3e8;" %>
<% end %>

  <div class="search-card">
    <% if @search_results.any? %>
    <h3>Search Results</h3>
      <ul>
        <% @search_results.each do |result| %>
          <li>
            <% if result.searchable_type == "Restaurant" %>
              <%= link_to result.searchable.name, restaurant_path(result.searchable.id), class: "card-link" %>
            <% else %>
              <%= link_to result.searchable.item_name, restaurant_menu_path(result.searchable.restaurant_menu_id), class: "card-link" %>
            <% end %>
            <div style="width: 300px; height: 300px;"
                data-controller="map"
                data-map-markers-value="<%= @markers.to_json %>"
                data-map-api-key-value="<%= ENV['MAPBOX_API_KEY'] %>">
            </div>
          </li>
        <% end %>
      </ul>
    <% else %>
    <h3>Suggested</h3>
      <div class="row">
        <% @sample_top_rated.each do |item| %>
          <%= link_to restaurant_menu_path(item.restaurant_menu), class: "card-link" do %>
            <div class="col-md-6">
              <div class="card">
                <div class="card-body d-flex justify-content-between">
                  <div>
                    <h5 class="card-info"><%= item.item_name %></h5>
                    <p class="card-info">R<%= item.item_price %></p>
                    <p class="card-info"><em><%= item.restaurant_menu.restaurant.name %></em></p>
                  </div>
                  <div>
                    <p class="card-info"><%= pluralize(item.ratings.count, 'vote') %></p>
                  </div>
                </div>
              </div>
            </div>
          <% end %>
        <% end %>
</div>

    <% end %>
  </div>
</div>

